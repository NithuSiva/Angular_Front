{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Ni2/Documents/Angular_Front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpHeaders } from '@angular/common/http';\nimport { EventEmitter } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\n// import { TicketService } from '../ticket/ticket.service';\nexport let StudentService = /*#__PURE__*/(() => {\n  class StudentService {\n    _httpClient;\n    studentList = [];\n    students$ = new BehaviorSubject([]);\n    studentHasBeenAdded = new EventEmitter();\n    studentHasBeenDeleted = new EventEmitter();\n    url = \"https://jsonplaceholder.typicode.com/users\";\n    studentListApi;\n    constructor(_httpClient /* , public ticketService: TicketService */) {\n      this._httpClient = _httpClient;\n    }\n    getData() {\n      let urlBackEnd = \"http://localhost:3000/api/students\";\n      return this._httpClient.get(urlBackEnd);\n    }\n    httpGetStudents() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        let urlBackEnd = \"http://localhost:3000/api/students\";\n        try {\n          yield _this._httpClient.get(urlBackEnd).subscribe(data => {\n            _this.studentListApi = data;\n            _this.studentListApi.forEach(element => {\n              let newStudent = {\n                'id': element['studentId'],\n                'firstName': element['firstName'],\n                'lastName': element['lastName']\n              };\n              _this.studentList.push(newStudent);\n            });\n            _this.students$.next(_this.studentList);\n          });\n        } catch (error) {\n          console.error(\"Erreur HTTP GET\");\n          throw error;\n        }\n      })();\n    }\n    httpPostStudent(data) {\n      let urlBackEndAddStudent = \"http://localhost:3000/api/students/ajouter\";\n      const headers = new HttpHeaders({\n        'Content-Type': 'application/json'\n      });\n      try {\n        this._httpClient.post(urlBackEndAddStudent, {\n          firstName: data.firstName,\n          lastName: data.lastName,\n          studentId: data.id\n        }).subscribe(res => {\n          let newStudent = {\n            'id': data.id,\n            'firstName': data.firstName,\n            'lastName': data.lastName\n          };\n          console.log(\"NEW STUDENT : \", newStudent);\n          this.studentList.push(newStudent);\n          this.students$.next(this.studentList);\n          this.studentHasBeenAdded.emit(newStudent);\n        });\n      } catch (error) {\n        console.error(\"Erreur HTTP POST\");\n        throw error;\n      }\n    }\n    httpDeleteStudent(id) {\n      console.log(\"httpDeleteStudent : \", id);\n      // this.ticketService.httpDeleteTicket(id);\n      let urlBackEndAddStudent = \"http://localhost:3000/api/students/supprimer/\" + id;\n      // const headers = new HttpHeaders({ 'Content-Type': 'application/json' });\n      // try {\n      //     this._httpClient.delete<any>(urlBackEndAddStudent)\n      //     .subscribe(res => {\n      //         this.studentHasBeenDeleted.emit();\n      //     }\n      //     );\n      // } catch (error) {\n      //     console.error(\"Erreur HTTP POST\");\n      //     throw error;\n      // }\n    }\n    // handleError(arg0: string, data: any): (err: any, caught: Observable<any>) => import(\"rxjs\").ObservableInput<any> {\n    //     throw new Error('Method not implemented.');\n    // }\n    getLastId() {\n      return this.studentList.length;\n    }\n    getStudentsSubject() {\n      return this.students$;\n    }\n    addStudent(student) {\n      // this.students$.value.push(student);\n      this.studentList.push(student);\n      this.students$.next(this.studentList);\n    }\n    getApiAndClearStudent() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        try {\n          yield _this2._httpClient.get(_this2.url).subscribe(data => {\n            _this2.studentListApi = data;\n            _this2.studentListApi.forEach(element => {\n              let temp = element['name'].split(' ');\n              let newStudent = {\n                'id': element['id'],\n                'firstName': temp[0],\n                'lastName': temp[1]\n              };\n              _this2.studentList.push(newStudent);\n            });\n            _this2.students$.next(_this2.studentList);\n          });\n        } catch (error) {\n          console.error(\"Erreur HTTP GET\");\n          throw error;\n        }\n      })();\n    }\n    static ɵfac = function StudentService_Factory(t) {\n      return new (t || StudentService)(i0.ɵɵinject(i1.HttpClient));\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: StudentService,\n      factory: StudentService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return StudentService;\n})();","map":{"version":3,"names":["HttpHeaders","EventEmitter","BehaviorSubject","StudentService","_httpClient","studentList","students$","studentHasBeenAdded","studentHasBeenDeleted","url","studentListApi","constructor","getData","urlBackEnd","get","httpGetStudents","_this","_asyncToGenerator","subscribe","data","forEach","element","newStudent","push","next","error","console","httpPostStudent","urlBackEndAddStudent","headers","post","firstName","lastName","studentId","id","res","log","emit","httpDeleteStudent","getLastId","length","getStudentsSubject","addStudent","student","getApiAndClearStudent","_this2","temp","split","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Ni2\\Documents\\Angular_Front\\src\\services\\student\\student.service.ts"],"sourcesContent":["import { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { EventEmitter, Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable, catchError  } from 'rxjs';\r\nimport { STUDENTS_MOCKED } from 'src/mocks/student.mock';\r\nimport { Student } from 'src/models/student';\r\n// import { TicketService } from '../ticket/ticket.service';\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\n\r\nexport class StudentService {\r\n\r\n    public studentList: Student[] = [];\r\n\r\n    public students$: BehaviorSubject<any[]> = new BehaviorSubject<any>([]);\r\n\r\n    public studentHasBeenAdded: EventEmitter<Student> = new EventEmitter<Student>();\r\n\r\n    public studentHasBeenDeleted: EventEmitter<Student> = new EventEmitter<Student>();\r\n\r\n\r\n    public url: string = \"https://jsonplaceholder.typicode.com/users\";\r\n\r\n    private studentListApi: any;\r\n\r\n    constructor(private _httpClient: HttpClient/* , public ticketService: TicketService */) {\r\n    }\r\n\r\n    getData(): Observable<any> {\r\n        let urlBackEnd = \"http://localhost:3000/api/students\";\r\n        return this._httpClient.get<any>(urlBackEnd);\r\n    }\r\n\r\n    async httpGetStudents(): Promise<void> {\r\n        let urlBackEnd = \"http://localhost:3000/api/students\";\r\n        try {\r\n            await this._httpClient.get(urlBackEnd)\r\n            .subscribe(data => {\r\n                this.studentListApi= (<any>data);\r\n                this.studentListApi.forEach((element: any) => {\r\n                    let newStudent: Student = {'id' :element['studentId'], 'firstName': element['firstName'], 'lastName': element['lastName']};\r\n                    this.studentList.push(newStudent);\r\n                });\r\n                this.students$.next(this.studentList);\r\n            }\r\n            );\r\n        } catch (error) {\r\n            console.error(\"Erreur HTTP GET\");\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    httpPostStudent(data: any){\r\n        let urlBackEndAddStudent = \"http://localhost:3000/api/students/ajouter\";\r\n        const headers = new HttpHeaders({ 'Content-Type': 'application/json' });\r\n        try {\r\n            this._httpClient.post<any>(urlBackEndAddStudent, {firstName: data.firstName, lastName: data.lastName, studentId: data.id})\r\n            .subscribe(res => {\r\n                let newStudent: Student = {'id' :data.id, 'firstName': data.firstName, 'lastName': data.lastName};\r\n                console.log(\"NEW STUDENT : \", newStudent)\r\n                this.studentList.push(newStudent);\r\n                this.students$.next(this.studentList);\r\n                this.studentHasBeenAdded.emit(newStudent);\r\n            }\r\n            );\r\n        } catch (error) {\r\n            console.error(\"Erreur HTTP POST\");\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    httpDeleteStudent(id: any){\r\n        console.log(\"httpDeleteStudent : \", id);\r\n        // this.ticketService.httpDeleteTicket(id);\r\n        let urlBackEndAddStudent = \"http://localhost:3000/api/students/supprimer/\" + id;\r\n        // const headers = new HttpHeaders({ 'Content-Type': 'application/json' });\r\n        // try {\r\n        //     this._httpClient.delete<any>(urlBackEndAddStudent)\r\n        //     .subscribe(res => {\r\n        //         this.studentHasBeenDeleted.emit();\r\n        //     }\r\n        //     );\r\n        // } catch (error) {\r\n        //     console.error(\"Erreur HTTP POST\");\r\n        //     throw error;\r\n        // }\r\n    }\r\n    \r\n    // handleError(arg0: string, data: any): (err: any, caught: Observable<any>) => import(\"rxjs\").ObservableInput<any> {\r\n    //     throw new Error('Method not implemented.');\r\n    // }\r\n\r\n    getLastId(){\r\n        return this.studentList.length;\r\n    }\r\n\r\n    getStudentsSubject() {\r\n        return this.students$;\r\n    }\r\n\r\n    addStudent(student: Student) {\r\n        // this.students$.value.push(student);\r\n        this.studentList.push(student);\r\n        this.students$.next(this.studentList);\r\n    }\r\n\r\n    async getApiAndClearStudent(): Promise<void>{\r\n        try {\r\n            await this._httpClient.get(this.url)\r\n            .subscribe(data => {\r\n                this.studentListApi= (<any>data);\r\n                this.studentListApi.forEach((element: any) => {\r\n                    let temp = element['name'].split(' ');\r\n                    let newStudent: Student = {'id' :element['id'], 'firstName': temp[0], 'lastName': temp[1]};\r\n                    this.studentList.push(newStudent);\r\n\r\n                    \r\n                });\r\n                this.students$.next(this.studentList);\r\n            }\r\n            );\r\n        } catch (error) {\r\n            console.error(\"Erreur HTTP GET\");\r\n            throw error;\r\n        }\r\n    }\r\n} \r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}