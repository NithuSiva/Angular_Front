{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Ni2/Documents/Angular_Front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let TicketService = /*#__PURE__*/(() => {\n  class TicketService {\n    _httpClient;\n    ticketList = [];\n    tickets$ = new BehaviorSubject(this.ticketList);\n    ticketListApi;\n    constructor(_httpClient) {\n      this._httpClient = _httpClient;\n    }\n    getBackEndTicketList() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        let urlBackEnd = \"http://localhost:3000/api/tickets\";\n        try {\n          yield _this._httpClient.get(urlBackEnd).subscribe(data => {\n            _this.ticketListApi = data;\n            _this.ticketListApi.forEach(element => {\n              let newStudent = {\n                'title': element['title'],\n                'firstName': element['FirstName'],\n                'lastName': element['LastName']\n                /*\n                \n                \"title\": \"TEST\",\n                \"description\": \"Description du voyage\",\n                \"date\": \"2012-04-30T02:15:12.356Z\",\n                \"id\": \"1551176391496\",\n                \"major\": \"GE\",\n                \"archived\": false\n                \n                */\n              };\n\n              _this.ticketList.push(newStudent);\n            });\n            _this.tickets$.next(_this.ticketList);\n          });\n        } catch (error) {\n          console.error(\"Erreur HTTP GET\");\n          throw error;\n        }\n      })();\n    }\n    addTicket(ticket) {\n      // You need here to update the list of ticket and then update our observable (Subject) with the new list\n      // More info: https://angular.io/tutorial/toh-pt6#the-searchterms-rxjs-subject\n      this.tickets$.value.push(ticket);\n      console.log(\"Ajout dans la liste: \", this.tickets$.value);\n      this.tickets$.next(this.ticketList);\n    }\n    archivedTicket(ticket) {\n      ticket.archived = true;\n      this.tickets$.next(this.ticketList);\n    }\n    deletedTicket(ticket) {\n      // this.tickets$.value.filter(tick => tick != ticket);\n      this.tickets$.value.splice(this.tickets$.value.indexOf(ticket), 1);\n      console.log(\"Suppresion dans la liste: \", this.tickets$.value);\n      this.tickets$.next(this.ticketList);\n    }\n    static ɵfac = function TicketService_Factory(t) {\n      return new (t || TicketService)(i0.ɵɵinject(i1.HttpClient));\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: TicketService,\n      factory: TicketService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return TicketService;\n})();","map":{"version":3,"names":["BehaviorSubject","TicketService","_httpClient","ticketList","tickets$","ticketListApi","constructor","getBackEndTicketList","_this","_asyncToGenerator","urlBackEnd","get","subscribe","data","forEach","element","newStudent","push","next","error","console","addTicket","ticket","value","log","archivedTicket","archived","deletedTicket","splice","indexOf","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Ni2\\Documents\\Angular_Front\\src\\services\\ticket\\ticket.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Ticket } from '../../models/ticket';\r\nimport { TICKETS_MOCKED } from '../../mocks/tickets.mock';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TicketService {\r\n\r\n  private ticketList: Ticket[] = [];\r\n\r\n  public tickets$: BehaviorSubject<Ticket[]> = new BehaviorSubject(this.ticketList);\r\n\r\n  private ticketListApi: any;\r\n\r\n\r\n  constructor(private _httpClient: HttpClient) {\r\n  }\r\n\r\n  async getBackEndTicketList(): Promise<void> {\r\n    let urlBackEnd = \"http://localhost:3000/api/tickets\";\r\n    try {\r\n        await this._httpClient.get(urlBackEnd)\r\n        .subscribe(data => {\r\n            this.ticketListApi= (<any>data);\r\n            this.ticketListApi.forEach((element: any) => {\r\n                let newStudent: Ticket = {\r\n\r\n                  'title' :element['title'], \r\n                  'firstName': element['FirstName'], \r\n                  'lastName': element['LastName']\r\n\r\n                  /* \r\n                  \r\n                  \"title\": \"TEST\",\r\n                  \"description\": \"Description du voyage\",\r\n                  \"date\": \"2012-04-30T02:15:12.356Z\",\r\n                  \"id\": \"1551176391496\",\r\n                  \"major\": \"GE\",\r\n                  \"archived\": false\r\n                  \r\n                  */\r\n\r\n                };\r\n                this.ticketList.push(newStudent);\r\n\r\n                \r\n            });\r\n            this.tickets$.next(this.ticketList);\r\n        }\r\n        );\r\n    } catch (error) {\r\n        console.error(\"Erreur HTTP GET\");\r\n        throw error;\r\n    }\r\n}\r\n\r\n  addTicket(ticket: Ticket) {\r\n    // You need here to update the list of ticket and then update our observable (Subject) with the new list\r\n    // More info: https://angular.io/tutorial/toh-pt6#the-searchterms-rxjs-subject\r\n    this.tickets$.value.push(ticket);\r\n    console.log(\"Ajout dans la liste: \", this.tickets$.value);\r\n    this.tickets$.next(this.ticketList)\r\n  }\r\n\r\n  archivedTicket(ticket: Ticket) {\r\n    ticket.archived = true;\r\n    this.tickets$.next(this.ticketList);\r\n  }\r\n\r\n   deletedTicket(ticket: Ticket) {\r\n    // this.tickets$.value.filter(tick => tick != ticket);\r\n    this.tickets$.value.splice(this.tickets$.value.indexOf(ticket), 1);\r\n    console.log(\"Suppresion dans la liste: \", this.tickets$.value);\r\n    this.tickets$.next(this.ticketList)\r\n  } \r\n}\r\n"],"mappings":";AAGA,SAASA,eAAe,QAAQ,MAAM;;;AAMtC,WAAaC,aAAa;EAApB,MAAOA,aAAa;IASJC,WAAA;IAPZC,UAAU,GAAa,EAAE;IAE1BC,QAAQ,GAA8B,IAAIJ,eAAe,CAAC,IAAI,CAACG,UAAU,CAAC;IAEzEE,aAAa;IAGrBC,YAAoBJ,WAAuB;MAAvB,KAAAA,WAAW,GAAXA,WAAW;IAC/B;IAEMK,oBAAoBA,CAAA;MAAA,IAAAC,KAAA;MAAA,OAAAC,iBAAA;QACxB,IAAIC,UAAU,GAAG,mCAAmC;QACpD,IAAI;UACA,MAAMF,KAAI,CAACN,WAAW,CAACS,GAAG,CAACD,UAAU,CAAC,CACrCE,SAAS,CAACC,IAAI,IAAG;YACdL,KAAI,CAACH,aAAa,GAAQQ,IAAK;YAC/BL,KAAI,CAACH,aAAa,CAACS,OAAO,CAAEC,OAAY,IAAI;cACxC,IAAIC,UAAU,GAAW;gBAEvB,OAAO,EAAED,OAAO,CAAC,OAAO,CAAC;gBACzB,WAAW,EAAEA,OAAO,CAAC,WAAW,CAAC;gBACjC,UAAU,EAAEA,OAAO,CAAC,UAAU;gBAE9B;;;;;;;;;;eAWD;;cACDP,KAAI,CAACL,UAAU,CAACc,IAAI,CAACD,UAAU,CAAC;YAGpC,CAAC,CAAC;YACFR,KAAI,CAACJ,QAAQ,CAACc,IAAI,CAACV,KAAI,CAACL,UAAU,CAAC;UACvC,CAAC,CACA;SACJ,CAAC,OAAOgB,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,iBAAiB,CAAC;UAChC,MAAMA,KAAK;;MACd;IACL;IAEEE,SAASA,CAACC,MAAc;MACtB;MACA;MACA,IAAI,CAAClB,QAAQ,CAACmB,KAAK,CAACN,IAAI,CAACK,MAAM,CAAC;MAChCF,OAAO,CAACI,GAAG,CAAC,uBAAuB,EAAE,IAAI,CAACpB,QAAQ,CAACmB,KAAK,CAAC;MACzD,IAAI,CAACnB,QAAQ,CAACc,IAAI,CAAC,IAAI,CAACf,UAAU,CAAC;IACrC;IAEAsB,cAAcA,CAACH,MAAc;MAC3BA,MAAM,CAACI,QAAQ,GAAG,IAAI;MACtB,IAAI,CAACtB,QAAQ,CAACc,IAAI,CAAC,IAAI,CAACf,UAAU,CAAC;IACrC;IAECwB,aAAaA,CAACL,MAAc;MAC3B;MACA,IAAI,CAAClB,QAAQ,CAACmB,KAAK,CAACK,MAAM,CAAC,IAAI,CAACxB,QAAQ,CAACmB,KAAK,CAACM,OAAO,CAACP,MAAM,CAAC,EAAE,CAAC,CAAC;MAClEF,OAAO,CAACI,GAAG,CAAC,4BAA4B,EAAE,IAAI,CAACpB,QAAQ,CAACmB,KAAK,CAAC;MAC9D,IAAI,CAACnB,QAAQ,CAACc,IAAI,CAAC,IAAI,CAACf,UAAU,CAAC;IACrC;;uBApEWF,aAAa,EAAA6B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;;aAAbhC,aAAa;MAAAiC,OAAA,EAAbjC,aAAa,CAAAkC,IAAA;MAAAC,UAAA,EAFZ;IAAM;;SAEPnC,aAAa;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}