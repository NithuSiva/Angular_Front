{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Ni2/Documents/M1_git/web/Angular_Front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let StudentService = /*#__PURE__*/(() => {\n  class StudentService {\n    _httpClient;\n    studentList = [];\n    students$ = new BehaviorSubject([]);\n    studentsObs$ = this.students$.asObservable();\n    url = \"https://jsonplaceholder.typicode.com/users\";\n    studentListApi;\n    constructor(_httpClient) {\n      this._httpClient = _httpClient;\n    }\n    getLastId() {\n      return this.studentList.length;\n    }\n    addStudent(student) {\n      console.log(\"Nouveau student\", student);\n      // this.students$.value.push(student);\n      this.studentList.push(student);\n      console.log(\"Ajout dans la liste: \", this.studentList);\n      this.students$.next(this.studentList);\n    }\n    getApiAndClearStudent() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        try {\n          yield _this._httpClient.get(_this.url).subscribe(data => {\n            _this.studentListApi = data;\n            _this.studentListApi.forEach(element => {\n              let temp = element['name'].split(' ');\n              let newStudent = {\n                'id': element['id'],\n                'firstName': temp[0],\n                'lastName': temp[1]\n              };\n              _this.studentList.push(newStudent);\n            });\n            _this.students$.next(_this.studentList);\n          });\n        } catch (error) {\n          console.error(\"Erreur HTTP GET\");\n          throw error;\n        }\n      })();\n    }\n    static ɵfac = function StudentService_Factory(t) {\n      return new (t || StudentService)(i0.ɵɵinject(i1.HttpClient));\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: StudentService,\n      factory: StudentService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return StudentService;\n})();","map":{"version":3,"names":["BehaviorSubject","StudentService","_httpClient","studentList","students$","studentsObs$","asObservable","url","studentListApi","constructor","getLastId","length","addStudent","student","console","log","push","next","getApiAndClearStudent","_this","_asyncToGenerator","get","subscribe","data","forEach","element","temp","split","newStudent","error","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Ni2\\Documents\\M1_git\\web\\Angular_Front\\src\\services\\student\\student.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, last } from 'rxjs';\r\nimport { STUDENTS_MOCKED } from 'src/mocks/student.mock';\r\nimport { Student } from 'src/models/student';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\n\r\nexport class StudentService {\r\n\r\n    private studentList: Student[] = [];\r\n\r\n    public students$: BehaviorSubject<any[]> = new BehaviorSubject<any>([]);\r\n    public studentsObs$ = this.students$.asObservable();\r\n\r\n    public url: string = \"https://jsonplaceholder.typicode.com/users\";\r\n    private studentListApi: any;\r\n    constructor(private _httpClient: HttpClient) {\r\n        \r\n    }\r\n\r\n    getLastId(){\r\n        return this.studentList.length;\r\n    }\r\n\r\n    addStudent(student: Student) {\r\n        console.log(\"Nouveau student\", student);\r\n        // this.students$.value.push(student);\r\n        this.studentList.push(student);\r\n        console.log(\"Ajout dans la liste: \", this.studentList);\r\n\r\n        this.students$.next(this.studentList);\r\n      }\r\n\r\n    async getApiAndClearStudent(): Promise<void>{\r\n        try {\r\n            await this._httpClient.get(this.url)\r\n            .subscribe(data => {\r\n                this.studentListApi= (<any>data);\r\n                this.studentListApi.forEach((element: any) => {\r\n                    let temp = element['name'].split(' ');\r\n                    let newStudent: Student = {'id' :element['id'], 'firstName': temp[0], 'lastName': temp[1]};\r\n                    this.studentList.push(newStudent);\r\n\r\n                    \r\n                });\r\n                this.students$.next(this.studentList);\r\n            }\r\n            );\r\n        } catch (error) {\r\n            console.error(\"Erreur HTTP GET\");\r\n            throw error;\r\n        }\r\n    }\r\n} "],"mappings":";AAEA,SAASA,eAAe,QAAc,MAAM;;;AAQ5C,WAAaC,cAAc;EAArB,MAAOA,cAAc;IASHC,WAAA;IAPZC,WAAW,GAAc,EAAE;IAE5BC,SAAS,GAA2B,IAAIJ,eAAe,CAAM,EAAE,CAAC;IAChEK,YAAY,GAAG,IAAI,CAACD,SAAS,CAACE,YAAY,EAAE;IAE5CC,GAAG,GAAW,4CAA4C;IACzDC,cAAc;IACtBC,YAAoBP,WAAuB;MAAvB,KAAAA,WAAW,GAAXA,WAAW;IAE/B;IAEAQ,SAASA,CAAA;MACL,OAAO,IAAI,CAACP,WAAW,CAACQ,MAAM;IAClC;IAEAC,UAAUA,CAACC,OAAgB;MACvBC,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEF,OAAO,CAAC;MACvC;MACA,IAAI,CAACV,WAAW,CAACa,IAAI,CAACH,OAAO,CAAC;MAC9BC,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAE,IAAI,CAACZ,WAAW,CAAC;MAEtD,IAAI,CAACC,SAAS,CAACa,IAAI,CAAC,IAAI,CAACd,WAAW,CAAC;IACvC;IAEIe,qBAAqBA,CAAA;MAAA,IAAAC,KAAA;MAAA,OAAAC,iBAAA;QACvB,IAAI;UACA,MAAMD,KAAI,CAACjB,WAAW,CAACmB,GAAG,CAACF,KAAI,CAACZ,GAAG,CAAC,CACnCe,SAAS,CAACC,IAAI,IAAG;YACdJ,KAAI,CAACX,cAAc,GAAQe,IAAK;YAChCJ,KAAI,CAACX,cAAc,CAACgB,OAAO,CAAEC,OAAY,IAAI;cACzC,IAAIC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC,CAACE,KAAK,CAAC,GAAG,CAAC;cACrC,IAAIC,UAAU,GAAY;gBAAC,IAAI,EAAEH,OAAO,CAAC,IAAI,CAAC;gBAAE,WAAW,EAAEC,IAAI,CAAC,CAAC,CAAC;gBAAE,UAAU,EAAEA,IAAI,CAAC,CAAC;cAAC,CAAC;cAC1FP,KAAI,CAAChB,WAAW,CAACa,IAAI,CAACY,UAAU,CAAC;YAGrC,CAAC,CAAC;YACFT,KAAI,CAACf,SAAS,CAACa,IAAI,CAACE,KAAI,CAAChB,WAAW,CAAC;UACzC,CAAC,CACA;SACJ,CAAC,OAAO0B,KAAK,EAAE;UACZf,OAAO,CAACe,KAAK,CAAC,iBAAiB,CAAC;UAChC,MAAMA,KAAK;;MACd;IACL;;uBA7CS5B,cAAc,EAAA6B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;;aAAdhC,cAAc;MAAAiC,OAAA,EAAdjC,cAAc,CAAAkC,IAAA;MAAAC,UAAA,EAHX;IAAM;;SAGTnC,cAAc;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}