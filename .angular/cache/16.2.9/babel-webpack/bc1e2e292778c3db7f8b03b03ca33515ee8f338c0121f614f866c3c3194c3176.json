{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../student/student.service\";\nexport let TicketService = /*#__PURE__*/(() => {\n  class TicketService {\n    _httpClient;\n    studentService;\n    ticketList = [];\n    tickets$ = new BehaviorSubject(this.ticketList);\n    ticketListApi;\n    constructor(_httpClient, studentService) {\n      this._httpClient = _httpClient;\n      this.studentService = studentService;\n    }\n    getTicketList() {\n      return this.ticketList;\n    }\n    getBackEndTicketList() {\n      let urlBackEnd = \"http://localhost:3000/api/tickets\";\n      try {\n        this._httpClient.get(urlBackEnd).subscribe(data => {\n          this.ticketListApi = data;\n          console.log(\"Element : \", this.ticketListApi);\n          this.ticketListApi.forEach(element => {\n            console.log(\"Element : \", element);\n            if (element.student.studentId == element['id']) {\n              let students = this.studentService.getData().subscribe(students => {\n                console.log('RESULT', result);\n              }, error => {\n                console.error('Erreur lors de la récupération des données :', error);\n              });\n              console.log(students);\n              // let studentCurrent: Student = {'id' :element2['studentId'], 'firstName': element2['FirstName'], 'lastName': element2['LastName']};\n              // let newStudent: Ticket = {\n              //   'title': element['title'],\n              //   'description': element['description'],\n              //   'date': element['date'],\n              //   'student': studentCurrent,\n              //   'major': element['major'],\n              //   'archived': element['archived']\n              // };\n              // this.ticketList.push(newStudent);\n            }\n          });\n\n          this.tickets$.next(this.ticketListApi);\n        });\n      } catch (error) {\n        console.error(\"Erreur HTTP GET\");\n        throw error;\n      }\n    }\n    addTicket(ticket) {\n      // You need here to update the list of ticket and then update our observable (Subject) with the new list\n      // More info: https://angular.io/tutorial/toh-pt6#the-searchterms-rxjs-subject\n      this.tickets$.value.push(ticket);\n      console.log(\"Ajout dans la liste: \", this.tickets$.value);\n      this.tickets$.next(this.ticketList);\n    }\n    archivedTicket(ticket) {\n      ticket.archived = true;\n      this.tickets$.next(this.ticketList);\n    }\n    deletedTicket(ticket) {\n      // this.tickets$.value.filter(tick => tick != ticket);\n      this.tickets$.value.splice(this.tickets$.value.indexOf(ticket), 1);\n      console.log(\"Suppresion dans la liste: \", this.tickets$.value);\n      this.tickets$.next(this.ticketList);\n    }\n    static ɵfac = function TicketService_Factory(t) {\n      return new (t || TicketService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.StudentService));\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: TicketService,\n      factory: TicketService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return TicketService;\n})();","map":{"version":3,"names":["BehaviorSubject","TicketService","_httpClient","studentService","ticketList","tickets$","ticketListApi","constructor","getTicketList","getBackEndTicketList","urlBackEnd","get","subscribe","data","console","log","forEach","element","student","studentId","students","getData","result","error","next","addTicket","ticket","value","push","archivedTicket","archived","deletedTicket","splice","indexOf","i0","ɵɵinject","i1","HttpClient","i2","StudentService","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Ni2\\Documents\\Angular_Front\\src\\services\\ticket\\ticket.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Ticket } from '../../models/ticket';\r\nimport { StudentService } from '../student/student.service';\r\nimport { Student } from 'src/models/student';\r\n\r\nimport { TICKETS_MOCKED } from '../../mocks/tickets.mock';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TicketService {\r\n\r\n  public ticketList: Ticket[] = [];\r\n\r\n  public tickets$: BehaviorSubject<Ticket[]> = new BehaviorSubject(this.ticketList);\r\n\r\n  private ticketListApi: any;\r\n\r\n  constructor(private _httpClient: HttpClient, public studentService: StudentService) {\r\n  }\r\n\r\n  getTicketList(){\r\n    return this.ticketList;\r\n  }\r\n\r\n  getBackEndTicketList(){\r\n    let urlBackEnd = \"http://localhost:3000/api/tickets\";\r\n    try {\r\n        this._httpClient.get(urlBackEnd)\r\n        .subscribe(data => {\r\n          this.ticketListApi = (<any>data);\r\n          console.log(\"Element : \", this.ticketListApi);\r\n\r\n          this.ticketListApi.forEach((element: any) => {\r\n            console.log(\"Element : \", element)\r\n        \r\n              if (element.student.studentId == element['id']) {\r\n                let students = this.studentService.getData().subscribe(\r\n                  (students) => {\r\n                    console.log('RESULT', result);\r\n                  },\r\n                  (error) => {\r\n                    console.error('Erreur lors de la récupération des données :', error);\r\n                  }\r\n                );\r\n                console.log(students)\r\n                // let studentCurrent: Student = {'id' :element2['studentId'], 'firstName': element2['FirstName'], 'lastName': element2['LastName']};\r\n              \r\n                // let newStudent: Ticket = {\r\n                //   'title': element['title'],\r\n                //   'description': element['description'],\r\n                //   'date': element['date'],\r\n                //   'student': studentCurrent,\r\n                //   'major': element['major'],\r\n                //   'archived': element['archived']\r\n                // };\r\n                // this.ticketList.push(newStudent);\r\n              }\r\n            \r\n          });\r\n          this.tickets$.next(this.ticketListApi);\r\n        }\r\n        );\r\n    } catch (error) {\r\n        console.error(\"Erreur HTTP GET\");\r\n        throw error;\r\n    }\r\n}\r\n\r\n  addTicket(ticket: Ticket) {\r\n    // You need here to update the list of ticket and then update our observable (Subject) with the new list\r\n    // More info: https://angular.io/tutorial/toh-pt6#the-searchterms-rxjs-subject\r\n    this.tickets$.value.push(ticket);\r\n    console.log(\"Ajout dans la liste: \", this.tickets$.value);\r\n    this.tickets$.next(this.ticketList)\r\n  }\r\n\r\n  archivedTicket(ticket: Ticket) {\r\n    ticket.archived = true;\r\n    this.tickets$.next(this.ticketList);\r\n  }\r\n\r\n   deletedTicket(ticket: Ticket) {\r\n    // this.tickets$.value.filter(tick => tick != ticket);\r\n    this.tickets$.value.splice(this.tickets$.value.indexOf(ticket), 1);\r\n    console.log(\"Suppresion dans la liste: \", this.tickets$.value);\r\n    this.tickets$.next(this.ticketList)\r\n  } \r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}